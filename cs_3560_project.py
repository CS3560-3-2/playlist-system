# -*- coding: utf-8 -*-
"""CS 3560 Project.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1XU82rU2cKDygnliFh_PdQhfFHIL63xVj
"""
import mysql.connector 
import os
import random
from api import getSong, playSong

# Note: methods are not all compilable, *** is used to note the methods/use cases that need work

mydb = mysql.connector.connect(
    host = "localhost",
    user = "root",
    password = "password",
    database = "playlist",
) 

cursor = mydb.cursor()
""" class Song:
  def __init__(self, name, artist, duration, id): #genre used for recommendations
    self._song_id = id
    self._song_name = name
    self._song_artist = artist
    self._song_duration = duration
  
  @property
  def getSong_id(self):
    return self._song_id
  
  @property
  def getSongName(self):
    return self._song_name
  
  @property
  def getSongArtist(self):
    return self._song_artist
  
  @property
  def songDuration(self):
    return self._song_duration
  
  @songDuration.setter
  def song_duration(self, value):
    self._song_duration = value
  
class FriendRequest:
  def __init__(self, sender, recipient):
      self.sender = sender
      self.recipient = recipient """

""" class Account:
  # Method to create an account ***
  def __init__(self, username, password):
    self._username = username
    self._password = password
    self._friend_list = []
    self._playlists = []

  # Sending a friend request ***
  def send_fr(username):
    if username: # If username exists in system
      # -> Send accept_fr to other 
      return None

  # Responding to a friend request ***
  def accept_fr():
    response = input("X has sent you a friend request: Would you like to accept or decline?")
    if (response == "Accept"):
      friendlist.append(username)
      return "You and user are now friends"
    else:
      return "You have declined the request"

  def getUsername(self):
    return self._username
  
  def getPassword(self):
    return self._password """
  
# Create subclass of music playlist for an account
''' class MusicPlaylist:
  # Method to create a playlist ***
  def __init__(self, playlist_name, playlist_duration):
    self.playlist_name = playlist_name
    self.playlist_songs = []
    self.playlist_duration = playlist_duration

  #add songs to list
  def addSong(self, song):
    self.playlist_songs.append(song)
    return("Song has been successfully added to playlist")

  #returns all songs in playlist
  def songs(self):
    return self.playlist_songs
  
  def getPlaylistName(self):
    return self.playlist_name
  
  def setPlaylistName(self, name):
    self.playlist_name = name
  
  def getPlaylistDuration(self):
    return self.playlist_duration
  
  def setPlaylistDuration(self, duration):
    self.playlist_duration = duration '''


#Methods that send songs to the database 
class DataBase:
  # Method that sends songs to song table in database
  def addSongs(name, artist, duration, id):
    addSong = "INSERT INTO Song (Name, Artist, Duration, song_ID) VALUES (%s, %s, %s, %s)"
    song = (name, artist, duration, id)
    cursor.execute(addSong,song)

  # Store list of all avalible accounts ***
  def addAccounts(username, password):
    addAccount = "INSERT INTO User (Username, Password) VALUES (%s, %s)"
    account = (username, password)
    cursor.execute(addAccount, account)

  # Store list of all public playlists ***
  def addPlaylists(name):
    addPlaylist = "INSERT INTO User (Name) VALUES (%s)"
    playlist = (name)
    cursor.execute(addPlaylist, playlist)

  #All getters and setters for the DataBase
  def getSongName(name, id):
    val = (name, id)
    command = "SELECT Name FROM Song WHERE Name = '%s' AND song_ID = '%s';"
    songName = cursor.execute(command, val)
    return songName
  
  def getSongArtist(artist, id):
    val = (artist, id)
    command = "SELECT Artist FROM Song WHERE Artist = '%s' AND song_ID = '%s';"
    songArtist = cursor.execute(command, val)
    return songArtist
  
  def getSongDuration(duration, id):
    val = (command, id)
    command = "SELECT Name FROM Song WHERE Name = '%s' AND song_ID = '%s';"
    songDuration = cursor.execte(command, val)
    return songDuration
  
  def getPlaylistName(name, id):
    val = (name, id)
    command = "SELECT Name FROM Playlist WHERE Name = '%s' AND playlist_ID = '%s';"
    playlistName = cursor.execute(command, val)
    return playlistName
  
  def getPlaylistLength(length, id):
    val = (length, id)
    command = "SELECT Length FROM Playlist WHERE Length = '%s' AND playlist_ID = '%s';"
    playlistLength = cursor.execute(command, val)
    return playlistLength
  
  def getPlaylistDuration(duration, id):
    val = (duration, id)
    command = "SELECT Duration FROM Playlist WHERE Duration = '%s' AND playlist_ID = '%s';"
    playlistLength = cursor.execute(command, val)
    return playlistLength
  
  def getAccountName(name, id):
    val = (name, id)
    command = "SELECT Username FROM User WHERE Username = '%s';"
    accountName = cursor.execute(command, val)
    return accountName

  def getAccountID(name):
    val = (name)
    command = "SELECT user_ID FROM User WHERE Username = '%s';"
    accountID = cursor.execute(command, val)
    return accountID

  def sendFriendRequest(usernameOne, usernameTwo):
    val = (usernameOne.getAccountID, usernameTwo.getAccountID)
    command = "INSERT INTO FriendRequest (user_ID, friend_ID) VALUES (%s, %s)"
    cursor.execute(command, val)

  def getFriendRequest(username):
    command = "SELECT * FROM FriendRequest WHERE user_ID = '%s';"
    requestList = cursor.execute(command, username.getAccountID)
    return requestList

  def addFriend(usernameOne, usernameTwo, acceptance):
    val = (usernameOne.getAccountID, usernameTwo.getAccountID)
    if acceptance == True :
      command = "UPDATE FriendRequest SET Added = 1; INSERT INTO Friends (user_ID, friend_ID) VALUES (%s, %s);"
      cursor.execute(command)
    else :
      command = "DELETE FROM FreindRequest WHERE user_ID = '%s' AND friend_ID = '%s';"
      cursor.execute(command,val)

  def getFriends(self):
    command = "SELECT * FROM Friends WHERE user_ID = '%s';"
    friendList = cursor.execute(command , self.getAccountID)
    return friendList

   